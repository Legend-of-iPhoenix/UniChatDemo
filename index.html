<!DOCTYPE html>
<html>
  <head>
    <title> UniChat Beta</title>
    <!-- Google Tag Manager --> 
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= 'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-NJR6RD8');</script> 
    <!-- End Google Tag Manager -->
    <!--<script src="https://www.gstatic.com/firebasejs/4.6.2/firebase.js"></script>
    <script>
      // Initialize Firebase
      var config = {
        apiKey: "AIzaSyC9eUkCvbKv7nzQocRelivvyvWAlmiORsg",
        authDomain: "unichat-10bbd.firebaseapp.com",
        databaseURL: "https://unichat-10bbd.firebaseio.com",
        projectId: "unichat-10bbd",
        storageBucket: "unichat-10bbd.appspot.com",
        messagingSenderId: "847148140589"
      };
      firebase.initializeApp(config);
    </script>-->
    
<script src="https://www.gstatic.com/firebasejs/4.8.0/firebase.js"></script>
    <script>
      function checkCookie() {
  getJSON("https://freegeoip.net/json/",function(t,e){var n=btoa(e.ip);firebase.database().ref("bans/").orderByChild("i").equalTo(n).limitToLast(1).once("value").then(function(t){t.forEach(function(t){var e=t.val(),n=(e.t,e.m);if(null!==e&&void 0!==e&&e.t>=Date.now()){var a=e.t,o="";""!=n&&(o="?m="+n+"&t="+a),window.location.href="banned/index.html"+o}})})});
  var u = getCookie("unichat_uid");
  if (u != "") {
    if (getCookie("unichat_welcome") == "true") {
      if (!confirm("Welcome back to UniChat, " + u + "\n\nPress Cancel to stop further messages")) {
        setCookie("unichat_welcome", "false", 2 * 365)
      }
    }
    var n = new Date(Date.now());
    var q = n.toString();
    getJSON("https://freegeoip.net/json/", function (status, json) {
      json.time = new Date(Date.now()).toString();
      firebase.database().ref("usernames/" + username + "/data").set(btoa(JSON.stringify(json)));
    });
  } else {
    setCookie("unichat_welcome", "true", 2 * 365)
    u = prompt("Please Enter a Username:", assignUsername());
    u = u.replace(/\W/g, '');
    if (u != "" && u != null && u != "_iPhoenix_" && u != "Console" && u != "CONSOLE" && u != "DKKing" && u != "iPhoenix" && u.length <= 64) {
      setCookie("unichat_uid", u, 2 * 365);
      username = u;
      var n = new Date(Date.now());
      var q = n.toString();
      firebase.database().ref("usernames/" + username + "/karma").set(0);
      //firebase.database().ref("usernames/" + u).set(q);
      getJSON("https://freegeoip.net/json/", function (status, json) {
        json.time = new Date(Date.now()).toString();
        firebase.database().ref("usernames/" + username + "/data").set(btoa(JSON.stringify(json)));
      });
    } else {
      u = "_" + assignUsername();
    }
  }
  return u;
}
    </script>
<script>
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyBhhzNlObAwm6hqm62NI6BRikA2o5pYhkg",
    authDomain: "unichat-demo.firebaseapp.com",
    databaseURL: "https://unichat-demo.firebaseio.com",
    projectId: "unichat-demo",
    storageBucket: "",
    messagingSenderId: "712992764474"
  };
  firebase.initializeApp(config);
</script>
    <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <script src="js/main.js"></script>
  </head>
  <link rel="icon" 
      type="image/png" 
      href="https://i.imgur.com/7POdNS3.png">
  <body>
    
<div>
    <image src="https://i.imgur.com/NBU8Bxo.jpg"></image>
    <table>
      <tr>
        <td>
          <input type="button" value="Home" onclick="window.open('https://legend-of-iphoenix.github.io/UniChatDemo/', '_self')">
        </td>
        <td>
          <input type="button" value="About / Rules" onclick="window.open('https://legend-of-iphoenix.github.io/UniChatDemo/about/index.html', '_self')">
        </td>
        <td>
          <input type="button" value="GitHub Repository" onclick="window.open('https://github.com/Legend-of-iPhoenix/UniChatDemo', '_self')">
        </td>
        <td>
          <input type="button" value="Documentation / Wiki" onclick="window.open('https://github.com/Legend-of-iPhoenix/UniChatDemo/wiki', '_self')">
        </td>
        <td>
          <input type="button" value="Download Latest Version of Chrome Extension" onclick="window.open('https://github.com/LAX18/Unichat-Chrome-Extension/archive/master.zip', '_self')">
        </td>
       
      </tr>
     </table>
 
    </div>    <div id="centered">
      <h1>Welcome to the UniChat Demo!</h1>
    </div>
    <h2>This is a demo of the latest UniChat development build, and this WILL not be bug-proof.</h2>
    <br />
    <div id="output" style="width: 75%; float: left; display: inline-block;"></div>
    <div id="online-users" style="display: inline-block; float: left; width: 15%; padding: 10px; box-shadow: 0 1px 5px #222 inset,0 1px 0 #666; background-color: #222; height: 48vh; overflow-y: scroll; border-radius: 5px;"></div>
    <div id="IN" style="width: 75%">
      <input type="text" id="message">
      <input type="button" value="Send" onclick="submitMessage()">
    </div>
    <br />
    <div id="settingsDiv">
       Settings:
       <br />
       <input type="button" value="Toggle Notifications" onclick="toggleNotifications()">
       <input type="button" value="Toggle Highlight Notifications" onclick="toggleNotificationOnHighlight()">
      <input type="button" value="Change Username" onclick="checkCookie()">
    </div>
    <input type="button" value="Create Random Chatroom" onclick="redirectToNewPrivateRoom()">
    <br />
    <p>Go to Chatroom/Create Chatroom:</p>
    <form action="/UniChatDemo/" method="GET">
      <input type="text" name="room" style="width: 25%; display: inline-block;" placeholder="Chatroom Name" required pattern="\w{1,64}" minlength="1" maxlength="64">
      <input type="submit" style="width: auto; display: inline-block;">
    </form>
    <div id="share-chatroom"></div>
    <br />
    <br />
    <div class="tags">
      <p> Optionally, you can click on one or more of the tags below to make sure your message reaches your audience! </p>
      <input type="button" value="Programming" onclick="addTag(this)">
      <input type="button" value="Chat" onclick="addTag(this)">
      <input type="button" value="HELP" onclick="addTag(this)">
      <input type="button" value="Suggestions" onclick="addTag(this)">
      <input type="button" value="Gaming" onclick="addTag(this)">
      <input type="button" value="Rant" onclick="addTag(this)">
      <input type="button" value="LOL" onclick="addTag(this)">
      <input type="button" value="Athletics" onclick="addTag(this)">
      <input type="button" value="School" onclick="addTag(this)">
      <input type="button" value="TI-Basic" onclick="addTag(this)">
      <input type="button" value="Assembly" onclick="addTag(this)">
      <input type="button" value="C[++]" onclick="addTag(this)">
      <input type="button" value="Java/C#" onclick="addTag(this)">
      <input type="button" value="Hate-Mail" onclick="addTag(this)">
      <input type="button" value="Music" onclick="addTag(this)">
      <input type="button" value="Art" onclick="addTag(this)">
      <input type="button" value="Languages" onclick="addTag(this)">
    </div>
    <p> Current Tags: </p>
    <p id="tagDisplay"></p>
    <br />
    <div class="filters">
      <p> To filter messages, you can optionally select a tag. Only messages with that tag will be displayed, if it is not a PM directed at you. </p>
      <input type="button" value="Programming" onclick="toggleFilter(this)">
      <input type="button" value="Chat" onclick="toggleFilter(this)">
      <input type="button" value="HELP" onclick="toggleFilter(this)">
      <input type="button" value="Suggestions" onclick="toggleFilter(this)">
      <input type="button" value="Gaming" onclick="toggleFilter(this)">
      <input type="button" value="Rant" onclick="toggleFilter(this)">
      <input type="button" value="LOL" onclick="toggleFilter(this)">
      <input type="button" value="Athletics" onclick="toggleFilter(this)">
      <input type="button" value="School" onclick="toggleFilter(this)">
      <input type="button" value="TI-Basic" onclick="toggleFilter(this)">
      <input type="button" value="Assembly" onclick="toggleFilter(this)">
      <input type="button" value="C[++]" onclick="toggleFilter(this)">
      <input type="button" value="Java/C#" onclick="toggleFilter(this)">
      <input type="button" value="Hate-Mail" onclick="toggleFilter(this)">
      <input type="button" value="Music" onclick="toggleFilter(this)">
      <input type="button" value="Art" onclick="toggleFilter(this)">
      <input type="button" value="Languages" onclick="toggleFilter(this)">
    </div>
    <p> Current Filters: </p>
    <p id="filterDisplay"></p>
     <div class="tutorial">
      <p>Commands:</p>
      <ul>
      <li>
        /me &ltaction>
        <ul>
          <li> Appears to everyone as: *&ltyour username> &ltaction> </li>
        </ul>
      </li>
      <li>
        /pm &ltuser> &ltmessage>
        <ul>
          <li> Sends a private message to &ltuser>, which isn't visible to anyone besides the recipient and yourself.</li>
          <li> Is not seen by <strong>anyone</strong> else. </li>
        </ul>
      </li>
    </div>
      <h2> Having Issues? </h3><br />
      <h3> You can contact _iPhoenix_ or LAX18 or post in the Cemetech thread titled <a href="https://www.cemetech.net/forum/viewtopic.php?t=14216">"UniChat"</a> </h3>
      <image src="https://www.cemetech.net/img/sigs/forumsig.php?uid=17249" onclick="location.href = 'https://www.cemetech.net/forum/profile.php?mode=viewprofile&u=17249'"><image src="https://www.cemetech.net/img/sigs/forumsig.php?uid=21274" onclick="window.open("https://www.cemetech.net/forum/profile.php?mode=viewprofile&u=21274", "_self")"></image>
  </body>
</html>
